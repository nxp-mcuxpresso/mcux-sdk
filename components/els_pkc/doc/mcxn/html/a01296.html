<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MCUX CLNS: mcuxClEls_Key_Import_Puk_DER_example.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MCUX CLNS
   </div>
   <div id="projectbrief">MCUX Crypto Library Normal Secure</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a01296.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mcuxClEls_Key_Import_Puk_DER_example.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Example of PuK import from a DER-encoded certificate using the ELS (CLNS component mcuxClEls)</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------*/</span></div><div class="line"><span class="comment">/* Copyright 2022-2023 NXP                                                  */</span></div><div class="line"><span class="comment">/*                                                                          */</span></div><div class="line"><span class="comment">/* NXP Confidential. This software is owned or controlled by NXP and may    */</span></div><div class="line"><span class="comment">/* only be used strictly in accordance with the applicable license terms.   */</span></div><div class="line"><span class="comment">/* By expressly accepting such terms or by downloading, installing,         */</span></div><div class="line"><span class="comment">/* activating and/or otherwise using the software, you are agreeing that    */</span></div><div class="line"><span class="comment">/* you have read, and that you agree to comply with and are bound by, such  */</span></div><div class="line"><span class="comment">/* license terms. If you do not agree to be bound by the applicable license */</span></div><div class="line"><span class="comment">/* terms, then you may not retain, install, activate or otherwise use the   */</span></div><div class="line"><span class="comment">/* software.                                                                */</span></div><div class="line"><span class="comment">/*--------------------------------------------------------------------------*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00293.html">mcuxClEls.h</a>&gt;</span> <span class="comment">// Interface to the entire mcuxClEls component</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00455.html">mcuxClMemory.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00599.html">mcuxCsslFlowProtection.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00260.html">mcuxClCore_FunctionIdentifiers.h</a>&gt;</span> <span class="comment">// Code flow protection</span></div><div class="line"><span class="preprocessor">#include &lt;mcuxClCore_Examples.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mcuxClExample_ELS_Helper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mcuxClExample_ELS_Key_Helper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;mcuxClExample_RFC3394_Helper.h&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a name="a0"></a><a class="code" href="a00032.html#a9aaa67299df29bf9b32ac94aa91dde50">der_certificate</a>[450U] = {</div><div class="line">    <span class="comment">// certificate</span></div><div class="line">    0x30U, 0x82U, 0x01U, 0xBEU, 0x30U, 0x82U, 0x01U, 0x63U, 0x02U, 0x14U, 0x14U, 0xFDU, 0x55U, 0xCAU, 0x4AU, 0x3BU,</div><div class="line">    0x27U, 0xB7U, 0x47U, 0xCAU, 0x12U, 0x5CU, 0xD4U, 0x52U, 0x6DU, 0x82U, 0xC9U, 0xB5U, 0xB7U, 0xA7U, 0x30U, 0x0AU,</div><div class="line">    0x06U, 0x08U, 0x2AU, 0x86U, 0x48U, 0xCEU, 0x3DU, 0x04U, 0x03U, 0x02U, 0x30U, 0x61U, 0x31U, 0x0BU, 0x30U, 0x09U,</div><div class="line">    0x06U, 0x03U, 0x55U, 0x04U, 0x06U, 0x13U, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U,</div><div class="line">    0x04U, 0x08U, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x07U, 0x0CU,</div><div class="line">    0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x0AU, 0x0CU, 0x02U, 0x30U, 0x30U,</div><div class="line">    0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x0BU, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U,</div><div class="line">    0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x03U, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x11U, 0x30U, 0x0FU, 0x06U, 0x09U,</div><div class="line">    0x2AU, 0x86U, 0x48U, 0x86U, 0xF7U, 0x0DU, 0x01U, 0x09U, 0x01U, 0x16U, 0x02U, 0x30U, 0x30U, 0x30U, 0x1EU, 0x17U,</div><div class="line">    0x0DU, 0x32U, 0x31U, 0x31U, 0x32U, 0x31U, 0x33U, 0x31U, 0x30U, 0x31U, 0x32U, 0x30U, 0x35U, 0x5AU, 0x17U, 0x0DU,</div><div class="line">    0x32U, 0x32U, 0x31U, 0x32U, 0x31U, 0x33U, 0x31U, 0x30U, 0x31U, 0x32U, 0x30U, 0x35U, 0x5AU, 0x30U, 0x61U, 0x31U,</div><div class="line">    0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x06U, 0x13U, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U,</div><div class="line">    0x06U, 0x03U, 0x55U, 0x04U, 0x08U, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U,</div><div class="line">    0x04U, 0x07U, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x0AU, 0x0CU,</div><div class="line">    0x02U, 0x30U, 0x30U, 0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x0BU, 0x0CU, 0x02U, 0x30U, 0x30U,</div><div class="line">    0x31U, 0x0BU, 0x30U, 0x09U, 0x06U, 0x03U, 0x55U, 0x04U, 0x03U, 0x0CU, 0x02U, 0x30U, 0x30U, 0x31U, 0x11U, 0x30U,</div><div class="line">    0x0FU, 0x06U, 0x09U, 0x2AU, 0x86U, 0x48U, 0x86U, 0xF7U, 0x0DU, 0x01U, 0x09U, 0x01U, 0x16U, 0x02U, 0x30U, 0x30U,</div><div class="line">    <span class="comment">// public key metadata</span></div><div class="line">    0x30U, 0x59U, 0x30U, 0x13U, 0x06U, 0x07U, 0x2AU, 0x86U, 0x48U, 0xCEU, 0x3DU, 0x02U, 0x01U, 0x06U, 0x08U, 0x2AU,</div><div class="line">    0x86U, 0x48U, 0xCEU, 0x3DU, 0x03U, 0x01U, 0x07U,</div><div class="line">    <span class="comment">// public key header</span></div><div class="line">    0x03U, 0x42U, 0x00U, 0x04U,</div><div class="line">    <span class="comment">// public key</span></div><div class="line">    0x12U, 0x54U, 0x6EU, 0xDBU, 0x7CU, 0xD4U, 0x85U, 0xBEU, 0xDDU, 0x5BU, 0x3BU, 0x71U, 0xB7U, 0x0EU, 0xC2U, 0x19U,</div><div class="line">    0x34U, 0x76U, 0x3BU, 0xAFU, 0xD2U, 0xE5U, 0xA2U, 0x76U, 0xCAU, 0xB6U, 0x09U, 0x63U, 0x09U, 0xA5U, 0x7FU, 0xEEU,</div><div class="line">    0xF9U, 0x74U, 0x18U, 0x5DU, 0x9AU, 0x4AU, 0x0EU, 0x88U, 0x4AU, 0xBEU, 0xF4U, 0xBEU, 0xBDU, 0xC9U, 0x96U, 0x64U,</div><div class="line">    0xBBU, 0xD5U, 0x67U, 0x94U, 0xACU, 0x9CU, 0x30U, 0xBAU, 0xF7U, 0xCFU, 0x36U, 0x18U, 0x91U, 0x10U, 0xE6U, 0x7EU,</div><div class="line">    <span class="comment">// signature header</span></div><div class="line">    0x30U, 0x0AU, 0x06U, 0x08U, 0x2AU, 0x86U, 0x48U, 0xCEU, 0x3DU, 0x04U, 0x03U, 0x02U, 0x03U, 0x49U, 0x00U, 0x30U,</div><div class="line">    0x46U,</div><div class="line">    <span class="comment">// signature x header</span></div><div class="line">    0x02U, 0x21U,</div><div class="line">    <span class="comment">// signature x</span></div><div class="line">    0x00U, 0xC3U, 0x08U, 0x77U, 0xFBU, 0x74U, 0x0FU, 0x18U, 0x57U, 0xC0U, 0x1EU, 0xE1U, 0x22U, 0x5CU, 0x07U, 0x54U,</div><div class="line">    0x29U, 0x2AU, 0xEAU, 0x79U, 0x1DU, 0x06U, 0xEFU, 0xF0U, 0x61U, 0xEAU, 0xB7U, 0xEDU, 0x83U, 0x5BU, 0x16U, 0x64U,</div><div class="line">    0x9BU,</div><div class="line">    <span class="comment">// signature y header</span></div><div class="line">    0x02U, 0x21U,</div><div class="line">    <span class="comment">// signature y</span></div><div class="line">    0x00U, 0xB0U, 0x8BU, 0xFAU, 0x21U, 0x8EU, 0x03U, 0x9BU, 0xA4U, 0x14U, 0x69U, 0x1AU, 0x81U, 0x93U, 0xF2U, 0x13U,</div><div class="line">    0x27U, 0x06U, 0x28U, 0x24U, 0xB1U, 0x1DU, 0x64U, 0x72U, 0x79U, 0xADU, 0x92U, 0x6EU, 0x9CU, 0xD2U, 0x79U, 0x8BU,</div><div class="line">    0xFDU</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#define SHA256_BLOCK_SIZE 64U</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">size_t</span> <a name="a1"></a><a class="code" href="a00032.html#af049ea7eafe6bdbb70ce3dd48adca426">der_certificate_offset_pbk</a> = 299U;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">size_t</span> <a name="a2"></a><a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> = 363U;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">static</span> uint8_t <a name="a3"></a><a class="code" href="a00032.html#adfc408cbf330d6e41a58a910f6a287d0">key_rfc3394</a>[MCUXCLELS_RFC3394_CONTAINER_SIZE_P256] = { 0U };</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">static</span> uint8_t <a name="a4"></a><a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[<span class="keyword">sizeof</span>(<a class="code" href="a00032.html#a9aaa67299df29bf9b32ac94aa91dde50">der_certificate</a>) + SHA256_BLOCK_SIZE] = { 0U };</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">static</span> <a class="code" href="a00733.html#gaaca57cf87336b1e866852443c47a019f">mcuxClEls_EccByte_t</a> <a name="a5"></a><a class="code" href="a00032.html#a961fa94f9b6e3852e50ad9417f7a6601">ecc_root_public_key</a>[<a name="a6"></a><a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a>] = { 0U };</div><div class="line"><span class="keyword">static</span> <a class="code" href="a00733.html#gaaca57cf87336b1e866852443c47a019f">mcuxClEls_EccByte_t</a> ecc_root_public_key_switched[<a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a>] = { 0U };</div><div class="line"></div><div class="line"><span class="keyword">static</span> <a class="code" href="a00733.html#gaaca57cf87336b1e866852443c47a019f">mcuxClEls_EccByte_t</a> <a name="a7"></a><a class="code" href="a00008.html#a0c919da2c9c7078b5c7243da9fa76322">ecc_signature</a>[<a name="a8"></a><a class="code" href="a00732.html#ga922fa06cbacda443d50f2b3c29fdea8c">MCUXCLELS_ECC_SIGNATURE_SIZE</a>] <a name="a9"></a><a class="code" href="a00032.html#a3e0329840494bde2557d01ee51c9aa52">__attribute__</a> ((aligned (4))) = { 0U };</div><div class="line"></div><div class="line"><span class="keyword">static</span> <a class="code" href="a00733.html#gaaca57cf87336b1e866852443c47a019f">mcuxClEls_EccByte_t</a> <a name="a10"></a><a class="code" href="a00008.html#a9723d2c5493f5403895e91d633105402">ecc_signature_r</a>[<a name="a11"></a><a class="code" href="a00732.html#ga18a35b4e98dac7862895339b720d667a">MCUXCLELS_ECC_SIGNATURE_R_SIZE</a>] <a class="code" href="a00032.html#a3e0329840494bde2557d01ee51c9aa52">__attribute__</a> ((aligned (4))) = { 0U };</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><a name="a12"></a><a class="code" href="a00032.html#afa131c8f7a3740ff4732892b4db16bec">MCUXCLEXAMPLE_FUNCTION</a>(mcuxClEls_Key_Import_Puk_DER_example)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_Init(<a name="a13"></a><a class="code" href="a00712.html#gac02fc8694aa89061b1eb47bad8fca21d">MCUXCLELS_RESET_DO_NOT_CANCEL</a>))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Key indices in internal keystore. */</span></div><div class="line">    uint8_t key_idx_helper_key            = 0u;</div><div class="line">    uint8_t key_idx_ecc_root_private_key  = 8u;</div><div class="line">    uint8_t key_idx_ecc_root_public_key   = 12u;</div><div class="line">    uint8_t key_idx_ecc_import_public_key = 16u;</div><div class="line"></div><div class="line"></div><div class="line">    <a name="a14"></a><a class="code" href="a00872.html#ga268f9c22cb59586556e0cbb21ac3320e">MCUX_CSSL_FP_FUNCTION_CALL_VOID_BEGIN</a>(token, <a name="a15"></a><a class="code" href="a00813.html#ga5d86af41c30044c28809914e2901884d">mcuxClMemory_set</a>(</div><div class="line">                 <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>,</div><div class="line">                 0x00,</div><div class="line">                 <span class="keyword">sizeof</span>(<a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>),</div><div class="line">                 <span class="keyword">sizeof</span>(<a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>)</div><div class="line">    ));</div><div class="line">    <span class="comment">// mcuxClMemory_set is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span> (<a name="a16"></a><a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00813.html#ga5d86af41c30044c28809914e2901884d">mcuxClMemory_set</a>) != token)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a name="a17"></a><a class="code" href="a00872.html#ga30de6960e0ce17187bce680980617f38">MCUX_CSSL_FP_FUNCTION_CALL_VOID_END</a>();</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga268f9c22cb59586556e0cbb21ac3320e">MCUX_CSSL_FP_FUNCTION_CALL_VOID_BEGIN</a>(token, <a name="a18"></a><a class="code" href="a00810.html#gab564183ab5f02cf11b66b6244ba2112a">mcuxClMemory_copy</a>(</div><div class="line">                 <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>,</div><div class="line">                 <a class="code" href="a00032.html#a9aaa67299df29bf9b32ac94aa91dde50">der_certificate</a>,</div><div class="line">                 <a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a>,</div><div class="line">                 <span class="keyword">sizeof</span>(<a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>)</div><div class="line">    ));</div><div class="line">    <span class="comment">// mcuxClMemory_copy is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00810.html#gab564183ab5f02cf11b66b6244ba2112a">mcuxClMemory_copy</a>) != token)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#ga30de6960e0ce17187bce680980617f38">MCUX_CSSL_FP_FUNCTION_CALL_VOID_END</a>();</div><div class="line"></div><div class="line">    <span class="comment">/* Set one bit after the certificate. */</span></div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a>] = 0x80;</div><div class="line"></div><div class="line">    <span class="comment">/* Compute length with added padding. */</span></div><div class="line">    <span class="keywordtype">size_t</span> der_certificate_paddedLength = (((uint32_t) (<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a>) + SHA256_BLOCK_SIZE - 1u) &amp; (~((uint32_t) SHA256_BLOCK_SIZE - 1u)));</div><div class="line"></div><div class="line">    <span class="comment">/* Set certificate length in last padding bytes. */</span></div><div class="line">    <span class="keywordtype">size_t</span> padIndex = der_certificate_paddedLength;</div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[--padIndex] = (uint8_t)(<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> &lt;&lt;  3u);</div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[--padIndex] = (uint8_t)(<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> &gt;&gt;  5u);</div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[--padIndex] = (uint8_t)(<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> &gt;&gt; 13u);</div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[--padIndex] = (uint8_t)(<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> &gt;&gt; 21u);</div><div class="line">    <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>[--padIndex] = (uint8_t)(<a class="code" href="a00032.html#a7edd27bd2edabd9a7a5c790b8605cd9a">der_certificate_len_without_signature</a> &gt;&gt; 29u);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Generate signing key */</span></div><div class="line">    <a name="_a19"></a><a class="code" href="a01141.html">mcuxClEls_EccKeyGenOption_t</a> keygen_options = {0};                  <span class="comment">// Initialize a new configuration for the planned mcuxClEls_EccKeyGen_Async operation.</span></div><div class="line">    keygen_options.<a name="a20"></a><a class="code" href="a01141.html#afc19db0547800dd35ed3d3294831344b">bits</a>.<a name="a21"></a><a class="code" href="a01141.html#aa60e98c0d7570daa80ab5536ebf71d94">kgsrc</a> = <a name="a22"></a><a class="code" href="a00730.html#ga67348b1833c0bfaccbe334c2cb68b448">MCUXCLELS_ECC_OUTPUTKEY_RANDOM</a>;        <span class="comment">// Configure that a non-deterministic key is generated.</span></div><div class="line">    keygen_options.<a class="code" href="a01141.html#afc19db0547800dd35ed3d3294831344b">bits</a>.<a name="a23"></a><a class="code" href="a01141.html#aa20a2dd1242cfa9c945d09332db760e1">kgsign</a> = <a name="a24"></a><a class="code" href="a00730.html#gaf73a03883462465c3cabb2257981fc5f">MCUXCLELS_ECC_PUBLICKEY_SIGN_DISABLE</a>; <span class="comment">// Configure that the key does not need to be signed.</span></div><div class="line">    keygen_options.<a class="code" href="a01141.html#afc19db0547800dd35ed3d3294831344b">bits</a>.<a name="a25"></a><a class="code" href="a01141.html#ade3f3190f07c3a1b8a5948988d3b85d5">kgtypedh</a> = <a name="a26"></a><a class="code" href="a00730.html#gacff4169a4b48ee6c6e8ac13e2ea025ab">MCUXCLELS_ECC_OUTPUTKEY_SIGN</a>;       <span class="comment">// Configure key to be a signing key.</span></div><div class="line"></div><div class="line">    <a name="_a27"></a><a class="code" href="a01237.html">mcuxClEls_KeyProp_t</a> keygen_prop = {0};                                <span class="comment">// Initialize a new configuration for the mcuxClEls_EccKeyGen_Async generated key properties.</span></div><div class="line">    keygen_prop.<a name="a28"></a><a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a29"></a><a class="code" href="a01237.html#a50d3bbaabf919fab908e2ae83fe5a5ab">upprot_priv</a> = <a name="a30"></a><a class="code" href="a00766.html#ga45d5d7ba7da1060c55a4bac5279841cc">MCUXCLELS_KEYPROPERTY_PRIVILEGED_TRUE</a>; <span class="comment">// Configure that user access rights: privileged access</span></div><div class="line">    keygen_prop.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a31"></a><a class="code" href="a01237.html#a0d130be83d337e7a5d9ef56f4a92f3a0">upprot_sec</a> = <a name="a32"></a><a class="code" href="a00766.html#gae85a65c3e6ae36cc74de69fa6a562a7a">MCUXCLELS_KEYPROPERTY_SECURE_FALSE</a>;     <span class="comment">// Configure that user access rights: non-secure access</span></div><div class="line"></div><div class="line">    <a name="a33"></a><a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a34"></a><a class="code" href="a00734.html#ga060362493427031ef51110b7c381a986">mcuxClEls_EccKeyGen_Async</a>( <span class="comment">// Perform key generation.</span></div><div class="line">            keygen_options,                                 <span class="comment">// Set the prepared configuration.</span></div><div class="line">            (<a class="code" href="a00768.html#ga769227492b28ef0d58a94b202113cee8">mcuxClEls_KeyIndex_t</a>) 0U,                       <span class="comment">// This parameter (signingKeyIdx) is ignored, since no signature is requested in the configuration.</span></div><div class="line">            key_idx_ecc_root_private_key,                   <span class="comment">// Keystore index at which the generated private key is stored.</span></div><div class="line">            keygen_prop,                                    <span class="comment">// Set the generated key properties.</span></div><div class="line">            NULL,                                           <span class="comment">// No random data is provided</span></div><div class="line">            <a class="code" href="a00032.html#a961fa94f9b6e3852e50ad9417f7a6601">ecc_root_public_key</a>                                  <span class="comment">// Output buffer, which the operation will write the public key to.</span></div><div class="line">            ));</div><div class="line">    <span class="comment">// mcuxClEls_EccKeyGen_Async is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span> ((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00734.html#ga060362493427031ef51110b7c381a986">mcuxClEls_EccKeyGen_Async</a>) != token) || (<a name="a35"></a><a class="code" href="a00767.html#ga0c69ecf4e48929c38549c8b430dae4b2">MCUXCLELS_STATUS_OK_WAIT</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR; <span class="comment">// Expect that no error occurred, meaning that the mcuxClEls_EccKeyGen_Async operation was started.</span></div><div class="line">    }</div><div class="line">    <a name="a36"></a><a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a37"></a><a class="code" href="a00717.html#ga396f130363332586a56b9667cf46fe7e">mcuxClEls_LimitedWaitForOperation</a>(0x00100000U, <a name="a38"></a><a class="code" href="a00711.html#ga3528b1fa2b3c39524898299a3a90a753">MCUXCLELS_ERROR_FLAGS_CLEAR</a>)); <span class="comment">// Wait for the mcuxClEls_EccKeyGen_Async operation to complete.</span></div><div class="line">    <span class="comment">// mcuxClEls_LimitedWaitForOperation is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00717.html#ga396f130363332586a56b9667cf46fe7e">mcuxClEls_LimitedWaitForOperation</a>) != token) || (<a name="a39"></a><a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <span class="comment">/* Sign certificate */</span></div><div class="line">    <a name="_a40"></a><a class="code" href="a01117.html">mcuxClEls_EccSignOption_t</a> sign_options = {0};           <span class="comment">// Initialize a new configuration for the planned mcuxClEls_EccSign_Async operation.</span></div><div class="line">    sign_options.<a name="a41"></a><a class="code" href="a01117.html#accf6312c26ce770b5647c4e45b00f7b5">bits</a>.<a name="a42"></a><a class="code" href="a01117.html#ab825e88899ff7627304d25fbcc1adffd">echashchl</a> = <a name="a43"></a><a class="code" href="a00729.html#ga871f176b3998d9b5dd709d5a6e2585bd">MCUXCLELS_ECC_NOT_HASHED</a>; <span class="comment">// Input is a full certificate, not a digest.</span></div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a44"></a><a class="code" href="a00734.html#ga96b17fadb9ee18906bb719e222908209">mcuxClEls_EccSign_Async</a>( <span class="comment">// Perform signature generation.</span></div><div class="line">            sign_options,                      <span class="comment">// Set the prepared configuration.</span></div><div class="line">            key_idx_ecc_root_private_key,      <span class="comment">// Set index of private key in keystore.</span></div><div class="line">            NULL,                              <span class="comment">// No input hash is provided</span></div><div class="line">            <a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>,            <span class="comment">// Input is the certificate</span></div><div class="line">            der_certificate_paddedLength,      <span class="comment">// Length of the certificate</span></div><div class="line">            <a class="code" href="a00008.html#a0c919da2c9c7078b5c7243da9fa76322">ecc_signature</a>                      <span class="comment">// Output buffer, which the operation will write the signature to.</span></div><div class="line">            ));</div><div class="line">    <span class="comment">// mcuxClEls_EccSign_Async is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span> ((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00734.html#ga96b17fadb9ee18906bb719e222908209">mcuxClEls_EccSign_Async</a>) != token) || (<a class="code" href="a00767.html#ga0c69ecf4e48929c38549c8b430dae4b2">MCUXCLELS_STATUS_OK_WAIT</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR; <span class="comment">// Expect that no error occurred, meaning that the mcuxClEls_EccSign_Async operation was started.</span></div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a class="code" href="a00717.html#ga396f130363332586a56b9667cf46fe7e">mcuxClEls_LimitedWaitForOperation</a>(0x00100000U, <a class="code" href="a00711.html#ga3528b1fa2b3c39524898299a3a90a753">MCUXCLELS_ERROR_FLAGS_CLEAR</a>)); <span class="comment">// Wait for the mcuxClEls_EccSign_Async operation to complete.</span></div><div class="line">    <span class="comment">// mcuxClEls_LimitedWaitForOperation is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00717.html#ga396f130363332586a56b9667cf46fe7e">mcuxClEls_LimitedWaitForOperation</a>) != token) || (<a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line"></div><div class="line">    <a class="code" href="a01237.html">mcuxClEls_KeyProp_t</a> key_properties;</div><div class="line"></div><div class="line">    <span class="comment">/* Provision helper key */</span></div><div class="line"></div><div class="line">    key_properties.<a name="a45"></a><a class="code" href="a01237.html#a270029567d10cf5d46c68f3fd5762394">word</a>.<a name="a46"></a><a class="code" href="a01237.html#af184a952f255348629f27f24c0fd0bd9">value</a> = 0U;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a50d3bbaabf919fab908e2ae83fe5a5ab">upprot_priv</a> = <a class="code" href="a00766.html#ga45d5d7ba7da1060c55a4bac5279841cc">MCUXCLELS_KEYPROPERTY_PRIVILEGED_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a0d130be83d337e7a5d9ef56f4a92f3a0">upprot_sec</a> =  <a name="a47"></a><a class="code" href="a00766.html#ga2088d83e8ab366a72075f52e3ca352ad">MCUXCLELS_KEYPROPERTY_SECURE_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a48"></a><a class="code" href="a01237.html#a18d3c3d356100d7bd01a9950c1f7b81e">uaes</a> = <a name="a49"></a><a class="code" href="a00766.html#gae292b4575efaa152a6a2704c05e079c7">MCUXCLELS_KEYPROPERTY_AES_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a50"></a><a class="code" href="a01237.html#ab0fe394151ed388fa03198d5710bc0d1">ukuok</a> = <a name="a51"></a><a class="code" href="a00766.html#ga116b9a68bec502c77b49b95189cdd51c">MCUXCLELS_KEYPROPERTY_KUOK_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a52"></a><a class="code" href="a01237.html#a49806c0136f41b701675799cb69d34d5">ksize</a> = <a name="a53"></a><a class="code" href="a00766.html#ga755a270fd53677522cafd0e56a6be66f">MCUXCLELS_KEYPROPERTY_KEY_SIZE_256</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a54"></a><a class="code" href="a01237.html#ad0617bc9eea63043b1faf5fe9814ba97">kactv</a> = <a name="a55"></a><a class="code" href="a00766.html#ga80e7d70c48a472dba6067d6b8e97bb68">MCUXCLELS_KEYPROPERTY_ACTIVE_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a56"></a><a class="code" href="a01237.html#ac8a7a5dac0515241438c5086d60ffcd2">kbase</a> = <a name="a57"></a><a class="code" href="a00766.html#ga8a549e38eaccd502bd48a82e95ff20f2">MCUXCLELS_KEYPROPERTY_BASE_SLOT</a>;</div><div class="line"></div><div class="line">    mcuxClEls_KeyProvisionOption_t key_provision_options;</div><div class="line">    key_provision_options.word.value = 0U;</div><div class="line">    key_provision_options.bits.noic = MCUXCLELS_KEYPROV_NOIC_ENABLE;</div><div class="line"></div><div class="line"><span class="preprocessor">        #error KEYPROV command not supported</span></div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a58"></a><a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>(<a class="code" href="a00711.html#ga3528b1fa2b3c39524898299a3a90a753">MCUXCLELS_ERROR_FLAGS_CLEAR</a>)); <span class="comment">// Wait for the mcuxClEls_Enable_Async operation to complete.</span></div><div class="line">    <span class="comment">// mcuxClEls_WaitForOperation is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>) != token) || (<a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Switch X and Y coordinates. */</span></div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a> / 2u; i++)</div><div class="line">    {</div><div class="line">        ecc_root_public_key_switched[i] = <a class="code" href="a00032.html#a961fa94f9b6e3852e50ad9417f7a6601">ecc_root_public_key</a>[i + <a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a> / 2u];</div><div class="line">        ecc_root_public_key_switched[i + <a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a> / 2u] = <a class="code" href="a00032.html#a961fa94f9b6e3852e50ad9417f7a6601">ecc_root_public_key</a>[i];</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Wrap public key. */</span></div><div class="line">    key_properties.<a class="code" href="a01237.html#a270029567d10cf5d46c68f3fd5762394">word</a>.<a class="code" href="a01237.html#af184a952f255348629f27f24c0fd0bd9">value</a> = 0u;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a49806c0136f41b701675799cb69d34d5">ksize</a>       = MCUXCLELS_KEYPROPERTY_KEY_SIZE_512;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a50d3bbaabf919fab908e2ae83fe5a5ab">upprot_priv</a> = <a class="code" href="a00766.html#ga45d5d7ba7da1060c55a4bac5279841cc">MCUXCLELS_KEYPROPERTY_PRIVILEGED_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.upuk        = MCUXCLELS_KEYPROPERTY_PUK_TRUE;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a0d130be83d337e7a5d9ef56f4a92f3a0">upprot_sec</a>  = <a class="code" href="a00766.html#gae85a65c3e6ae36cc74de69fa6a562a7a">MCUXCLELS_KEYPROPERTY_SECURE_FALSE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#ad0617bc9eea63043b1faf5fe9814ba97">kactv</a>       = <a class="code" href="a00766.html#ga80e7d70c48a472dba6067d6b8e97bb68">MCUXCLELS_KEYPROPERTY_ACTIVE_TRUE</a>;</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> wrap_result = mcuxClExample_rfc3394_wrap(</div><div class="line">    <span class="comment">/*const uint8_t * pInput        */</span> ecc_root_public_key_switched, <span class="comment">/*  pointer to key to be wrapped */</span></div><div class="line">    <span class="comment">/*size_t inputLength,           */</span> <a class="code" href="a00732.html#ga7298491d4e2d679496d0bacab6f351f8">MCUXCLELS_ECC_PUBLICKEY_SIZE</a>,  <span class="comment">/*  length of key to be wrapped in bytes */</span></div><div class="line">    <span class="comment">/*const uint8_t * pKek_in       */</span> NULL,                         <span class="comment">/*  pointer to key wrapping key */</span></div><div class="line">    <span class="comment">/*mcuxClEls_KeyIndex_t keyIdx    */</span> key_idx_helper_key,           <span class="comment">/*  keyslot index of key wrapping key */</span></div><div class="line">    <span class="comment">/*uint8_t extkey                */</span> 0U,                           <span class="comment">/*  0-use key stored internally at keyIdx as wrapping key, 1-use external pKek_in as wrapping key */</span></div><div class="line">    <span class="comment">/*size_t kekLength              */</span> 0U,                           <span class="comment">/*  length of key wrapping key in bytes */</span></div><div class="line">    <span class="comment">/*uint8_t * pOutput             */</span> <a class="code" href="a00032.html#adfc408cbf330d6e41a58a910f6a287d0">key_rfc3394</a>,                  <span class="comment">/*  pointer to output buffer, size has to be inputLength + 16 bytes */</span></div><div class="line">    <span class="comment">/*mcuxClEls_KeyProp_t properties */</span> key_properties);              <span class="comment">/*  properties of the key to be wrapped */</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (!wrap_result)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Import root public key. */</span></div><div class="line">    <a name="_a59"></a><a class="code" href="a01225.html">mcuxClEls_KeyImportOption_t</a> import_options;</div><div class="line">    import_options.<a name="a60"></a><a class="code" href="a01225.html#a9a03426cf6b706ee292473b3d695ebe0">word</a>.<a name="a61"></a><a class="code" href="a01225.html#ad5bfabd7e1e04a95627e0cbc144afdcb">value</a> = 0u;</div><div class="line">    import_options.<a name="a62"></a><a class="code" href="a01225.html#ad0fc563d3f708b06c986ec2ae604d69e">bits</a>.<a name="a63"></a><a class="code" href="a01225.html#ae3892b035704c00a855dd43d96a21b2c">kfmt</a> = <a name="a64"></a><a class="code" href="a00756.html#gaa3f8c4e99d3c233eeaa2685d9e0d4b67">MCUXCLELS_KEYIMPORT_KFMT_RFC3394</a>;</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a65"></a><a class="code" href="a00759.html#ga867d4be563b347273af25a559abd7f87">mcuxClEls_KeyImport_Async</a>(import_options,</div><div class="line">                                                   <a class="code" href="a00032.html#adfc408cbf330d6e41a58a910f6a287d0">key_rfc3394</a>,</div><div class="line">                                                   MCUXCLELS_RFC3394_CONTAINER_SIZE_P256,</div><div class="line">                                                   key_idx_helper_key,</div><div class="line">                                                   key_idx_ecc_root_public_key</div><div class="line">    )); <span class="comment">// Wait for the mcuxClEls_KeyImportPuk_Async operation to complete.</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00759.html#ga867d4be563b347273af25a559abd7f87">mcuxClEls_KeyImport_Async</a>) != token) || (<a class="code" href="a00767.html#ga0c69ecf4e48929c38549c8b430dae4b2">MCUXCLELS_STATUS_OK_WAIT</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>(<a class="code" href="a00711.html#ga3528b1fa2b3c39524898299a3a90a753">MCUXCLELS_ERROR_FLAGS_CLEAR</a>)); <span class="comment">// Wait for the mcuxClEls_Enable_Async operation to complete.</span></div><div class="line">    <span class="comment">// mcuxClEls_WaitForOperation is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>) != token) || (<a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line"></div><div class="line">    key_properties.<a class="code" href="a01237.html#a270029567d10cf5d46c68f3fd5762394">word</a>.<a class="code" href="a01237.html#af184a952f255348629f27f24c0fd0bd9">value</a> = 0u;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a50d3bbaabf919fab908e2ae83fe5a5ab">upprot_priv</a> = <a class="code" href="a00766.html#ga45d5d7ba7da1060c55a4bac5279841cc">MCUXCLELS_KEYPROPERTY_PRIVILEGED_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a0d130be83d337e7a5d9ef56f4a92f3a0">upprot_sec</a>  = <a class="code" href="a00766.html#gae85a65c3e6ae36cc74de69fa6a562a7a">MCUXCLELS_KEYPROPERTY_SECURE_FALSE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a name="a66"></a><a class="code" href="a01237.html#a8b01f95eb9069953fe7a48b6ec85e479">wrpok</a>       = <a name="a67"></a><a class="code" href="a00766.html#gaf07168a64eb99d5788e096d735871c3f">MCUXCLELS_KEYPROPERTY_WRAP_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#ad0617bc9eea63043b1faf5fe9814ba97">kactv</a>       = <a class="code" href="a00766.html#ga80e7d70c48a472dba6067d6b8e97bb68">MCUXCLELS_KEYPROPERTY_ACTIVE_TRUE</a>;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a49806c0136f41b701675799cb69d34d5">ksize</a>       = MCUXCLELS_KEYPROPERTY_KEY_SIZE_512;</div><div class="line">    key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.upuk        = MCUXCLELS_KEYPROPERTY_PUK_TRUE;</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, mcuxClEls_KeyImportPuk_Async(<a class="code" href="a00032.html#adf7528a77c2e6b48821cbed7c0337096">der_certificate_import</a>,</div><div class="line">                                                der_certificate_paddedLength,</div><div class="line">                                                <a class="code" href="a00032.html#af049ea7eafe6bdbb70ce3dd48adca426">der_certificate_offset_pbk</a>,</div><div class="line">                                                <a class="code" href="a00008.html#a0c919da2c9c7078b5c7243da9fa76322">ecc_signature</a>,</div><div class="line">                                                key_idx_ecc_root_public_key,</div><div class="line">                                                key_properties,</div><div class="line">                                                key_idx_ecc_import_public_key,</div><div class="line">                                                <a class="code" href="a00008.html#a9723d2c5493f5403895e91d633105402">ecc_signature_r</a>)); <span class="comment">// Wait for the mcuxClEls_KeyImportPuk_Async operation to complete.</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(mcuxClEls_KeyImportPuk_Async) != token) || (<a class="code" href="a00767.html#ga0c69ecf4e48929c38549c8b430dae4b2">MCUXCLELS_STATUS_OK_WAIT</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>(<a class="code" href="a00711.html#ga3528b1fa2b3c39524898299a3a90a753">MCUXCLELS_ERROR_FLAGS_CLEAR</a>)); <span class="comment">// Wait for the mcuxClEls_Enable_Async operation to complete.</span></div><div class="line">    <span class="comment">// mcuxClEls_WaitForOperation is a flow-protected function: Check the protection token and the return value</span></div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00717.html#gaee73cb4825b7722d9e085565170eb18e">mcuxClEls_WaitForOperation</a>) != token) || (<a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <span class="comment">/* Verify R. */</span></div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00732.html#ga18a35b4e98dac7862895339b720d667a">MCUXCLELS_ECC_SIGNATURE_R_SIZE</a>; i++)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> ((uint8_t) <a class="code" href="a00008.html#a0c919da2c9c7078b5c7243da9fa76322">ecc_signature</a>[i] != (uint8_t) <a class="code" href="a00008.html#a9723d2c5493f5403895e91d633105402">ecc_signature_r</a>[i])</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify key properties of imported key. */</span></div><div class="line">    <a class="code" href="a01237.html">mcuxClEls_KeyProp_t</a> key_properties_imported;</div><div class="line"></div><div class="line">    <a class="code" href="a00872.html#ga8a9b1ebbc02c8195618a339aa8e0003d">MCUX_CSSL_FP_FUNCTION_CALL_BEGIN</a>(result, token, <a name="a68"></a><a class="code" href="a00759.html#ga524d99bbf9aae0d299fbb52d2a121c4f">mcuxClEls_GetKeyProperties</a>(key_idx_ecc_import_public_key, &amp;key_properties_imported));</div><div class="line">    <span class="keywordflow">if</span>((<a class="code" href="a00872.html#gac16ad6597579a02a30ada37f86f216d5">MCUX_CSSL_FP_FUNCTION_CALLED</a>(<a class="code" href="a00759.html#ga524d99bbf9aae0d299fbb52d2a121c4f">mcuxClEls_GetKeyProperties</a>) != token) || (<a class="code" href="a00767.html#ga022996920a649ed71428ed73e53eae8a">MCUXCLELS_STATUS_OK</a> != result))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <a class="code" href="a00872.html#gac4362de43d0e67ba6fac0057eb38008d">MCUX_CSSL_FP_FUNCTION_CALL_END</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a49806c0136f41b701675799cb69d34d5">ksize</a> != key_properties_imported.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#a49806c0136f41b701675799cb69d34d5">ksize</a>)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#ad0617bc9eea63043b1faf5fe9814ba97">kactv</a> != key_properties_imported.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.<a class="code" href="a01237.html#ad0617bc9eea63043b1faf5fe9814ba97">kactv</a>)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (key_properties.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.upuk != key_properties_imported.<a class="code" href="a01237.html#abcae2eaaf0826e5548f0b416ecfff0b4">bits</a>.upuk)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_KeyDelete(key_idx_helper_key))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_KeyDelete(key_idx_ecc_root_private_key))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_KeyDelete(key_idx_ecc_root_public_key))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_KeyDelete(key_idx_ecc_import_public_key))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!mcuxClExample_Els_Disable())</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_ERROR;</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> MCUXCLEXAMPLE_STATUS_OK;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
